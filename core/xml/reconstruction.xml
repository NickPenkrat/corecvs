<poco version="5.0">

  <!-- old data -->
  <class name="Photostation Placer Essential Filter Parameters">
    <field type="double" name="b2bRansacP5RPThreshold"       defaultValue="0.8" min="-50000" max="50000" comment="Best-2nd best essential estimator threshold"/>
    <field type="double" name="inlierP5RPThreshold"          defaultValue="5.0" min="-50000" max="50000" comment="Inlier threshold"/>

    <field type="int"    name="maxEssentialRansacIterations" defaultValue="600000" min="0" max="5000000" step="100" comment="Maximal essential estimator rounds"/>

    <field type="double" name="b2bRansacP6RPThreshold" defaultValue="0.8" min="-50000" max="50000" comment="Best-2nd best relative pose estimator threshold" />
    <field type="bool"   name="runEssentialFiltering"  defaultValue="true"                         comment="Run essential filtering prior relative pose estimation" />
    <field type="double" name="essentialTargetGamma"   defaultValue="0.01" min="0" max="50000"  step="0.01" />
    <field type="int" name="maxP6RPIterations" defaultValue="400000" comment="Maximal number of ransac iterations for pose estimation using pairwise correspondences"/>
    <field type="double" name="inlierP6RPThreshold" defaultValue="1.0" comment="Inlier threshold for pose estimation using pairwise correspondences"/>
    <field type="double" name="gammaP6RP" defaultValue="0.001" comment="Target failure probability for pose estimation" />
  </class>

  <!-- old data -->
  
  <!-- new data -->

  <class name="Iterative Reconstruction Initialization Params">
    <field type="double" name="b2bRansacP5RPThreshold"       defaultValue="0.8" min="-50000" max="50000" comment="Best-2nd best essential estimator threshold"/>
    <field type="double" name="inlierP5RPThreshold"          defaultValue="5.0" min="-50000" max="50000" comment="Inlier threshold"/>

    <field type="int"    name="maxEssentialRansacIterations" defaultValue="600000" min="0" max="5000000" step="100" comment="Maximal essential estimator rounds"/>

    <field type="double" name="b2bRansacP6RPThreshold" defaultValue="0.8" min="-50000" max="50000" comment="Best-2nd best relative pose estimator threshold" />
    <field type="bool"   name="runEssentialFiltering"  defaultValue="true"                         comment="Run essential filtering prior relative pose estimation" />
    <field type="double" name="essentialTargetGamma"   defaultValue="0.01" min="0" max="50000"  step="0.01" />
    <field type="int" name="maxP6RPIterations" defaultValue="400000" comment="Maximal number of ransac iterations for pose estimation using pairwise correspondences"/>
    <field type="double" name="inlierP6RPThreshold" defaultValue="1.0" comment="Inlier threshold for pose estimation using pairwise correspondences"/>
    <field type="double" name="gammaP6RP" defaultValue="0.001" comment="Target failure probability for pose estimation" />
  </class>

  <!-- new data -->

  <!-- old data -->
  
  <class name="Photostation Placer Feature Selection Parameters">
    <field type="double" name="inlierThreshold"             defaultValue="5.0"  min="-50000" max="50000" comment="Inlier threshold"/>
    <field type="double" name="trackInlierThreshold"        defaultValue="3.0"  min="-50000" max="50000" comment="Track append threshold"/>
    <field type="double" name="distanceLimit"               defaultValue="1000" min="-50000" max="50000" comment="Track distance limit"/>

    <field type="string" name="detector"     defaultValue="ORB"   comment="Detector" />
    <field type="string" name="descriptor"   defaultValue="ORB"   comment="Descriptor" />
    <field type="string" name="matcher"      defaultvalue="BF"    comment="Matcher" />
    <field type="double" name="b2bThreshold" defaultValue="0.9"   comment="b2b threshold" />
    <filed type="bool"   name="matchF2F"     defaultValue="false" comment="Match F2F" />

    <field type="double" name="rmsePruningScaler" defaultValue="3.0" comment="RMSE pruning scaler" />
    <field type="double" name="maxPruningScaler"  defaultValue="5.0" comment="Max pruning scaler" />
  </class>

  <class name="Photostation Append Parameters">
    <field type="int"    name="maxPostAppend"      defaultValue="2"      comment="Maximal post-append iterations" />
    <field type="double" name="inlierP3PThreshold" defaultvalue="2.0"    comment="Inlier threshold for 3P->pose" />
    <field type="int"    name="maxP3PIterations"   defaultValue="100000" comment="Maximal ransac iterations for 3P->pose" />
    <filed type="double" name="gammaP3P"           defaultvalue="0.001"  comment="Target error probability for 3P pose estimation" />
    <field type="double" name="inlierP6PThreshold" defaultvalue="1.0"    comment="Inlier threshold for 6P->pose/3P->orientation" />
    <field type="int"    name="maxP6PIterations"   defaultvalue="400000" comment="Maximal ransac iterations for 6P->pose/3P->orientation" />
    <field type="double" name="gammaP6P"           defaultValue="0.001"  comment="Target error probability for 6P->pose/3P->orientation" />
    <field type="size_t" name="speculativity"      defaultValue="1000"   comment="This defines how many multicameras are subject for P3P evaluation at each iteration" />
    <field type="size_t" name="minimalInlierCount" defaultValue="32"     comment="Minimal inlier count for hypotheis acceptance" />
    <field type="double" name="maximalFailureProbability" defaultValue="0.15" comment="Maximal failure probability for hypothesis acceptance" />
  </class>

  <!-- old data -->

  <!-- new data -->
  
  <class name="Iterative Reconstruction Feature Selection Params">
    <field type="double" name="inlierThreshold"             defaultValue="5.0"  min="-50000" max="50000" comment="Inlier threshold"/>
    <field type="double" name="trackInlierThreshold"        defaultValue="3.0"  min="-50000" max="50000" comment="Track append threshold"/>
    <field type="double" name="distanceLimit"               defaultValue="1000" min="-50000" max="50000" comment="Track distance limit"/>

    <field type="string" name="detector"     defaultValue="ORB"   comment="Detector" />
    <field type="string" name="descriptor"   defaultValue="ORB"   comment="Descriptor" />
    <field type="string" name="matcher"      defaultvalue="BF"    comment="Matcher" />
    <field type="double" name="b2bThreshold" defaultValue="0.9"   comment="b2b threshold" />
    <filed type="bool"   name="matchF2F"     defaultValue="false" comment="Match F2F" />

    <field type="double" name="rmsePruningScaler" defaultValue="3.0" comment="RMSE pruning scaler" />
    <field type="double" name="maxPruningScaler"  defaultValue="5.0" comment="Max pruning scaler" />
  </class>

  <class name="Iterative Reconstruction Append Params">
    <field type="int"    name="maxPostAppend"      defaultValue="2"      comment="Maximal post-append iterations" />
    <field type="double" name="inlierP3PThreshold" defaultvalue="2.0"    comment="Inlier threshold for 3P->pose" />
    <field type="int"    name="maxP3PIterations"   defaultValue="100000" comment="Maximal ransac iterations for 3P->pose" />
    <filed type="double" name="gammaP3P"           defaultvalue="0.001"  comment="Target error probability for 3P pose estimation" />
    <field type="double" name="inlierP6PThreshold" defaultvalue="1.0"    comment="Inlier threshold for 6P->pose/3P->orientation" />
    <field type="int"    name="maxP6PIterations"   defaultvalue="400000" comment="Maximal ransac iterations for 6P->pose/3P->orientation" />
    <field type="double" name="gammaP6P"           defaultValue="0.001"  comment="Target error probability for 6P->pose/3P->orientation" />
    <field type="size_t" name="speculativity"      defaultValue="1000"   comment="This defines how many multicameras are subject for P3P evaluation at each iteration" />
    <field type="size_t" name="minimalInlierCount" defaultValue="32"     comment="Minimal inlier count for hypotheis acceptance" />
    <field type="double" name="maximalFailureProbability" defaultValue="0.15" comment="Maximal failure probability for hypothesis acceptance" />
  </class>

  <!-- new data -->

  <!-- old data -->
  
  <class name="Photostation Placer Params Base">
    <field type="bool"   name="forceGps"  defaultValue="true" comment="Enforce gps locations" />
    <field type="int"    name="speculativity"             defaultValue="1000" min="-50000" max="50000" comment="This defines how many multicameras are subject for P3P evaluation at each iteration" />
    <field type="int"    name="minimalInlierCount"        defaultValue="32"   min="-50000" max="50000"/>
    <field type="double" name="maximalFailureProbability" defaultValue="0.15" min="-50000" max="50000"/>
  </class>


  <enum name="Photostation Placer Optimization Error Type">
    <item name="REPROJECTION"  id="0" />
    <item name="ANGULAR"       id="1" />
    <item name="CROSS_PRODUCT" id="2" />
    <item name="RAY_DIFF"      id="3" />
  </enum>

  <class name="Photostation Nonlinear Optimization Parameters">
    <!-- // By default only orientations and reconstructed points are subject for optimization -->
    <!-- <filed type="ReconstructionFunctorOptimizationType" name="optimizationParams" defaultValue= -->
    <!--     ReconstructionFunctorOptimizationType::NON_DEGENERATE_ORIENTATIONS | ReconstructionFunctorOptimizationType::DEGENERATE_ORIENTATIONS | ReconstructionFunctorOptimizationType::FOCALS | ReconstructionFunctorOptimizationType::PRINCIPALS | -->
    <!--     ReconstructionFunctorOptimizationType::POINTS; -->
        
    <field type="ReconstructionFunctorOptimizationErrorType" name="errorType" defaultvalue="ReconstructionFunctorOptimizationErrorType::RAY_DIFF" comment="Functor optimizattion error type" />
    <field type="int" name="postAppendNonlinearIterations" defaultValue="200" comment="Post-append non-linear optimization iterations" />
    <field type="int" name="finalNonLinearIterations" defaultValue="2000" comment="Final non-linear iterations" />
    <field type="int" name="alternatingIterations" defaultValue="20" comment="Alternating optimization on success steps" />

    <field type="bool" name="excessiveQuaternionParametrization" defaultValue="true" comment="Excessive/non-excessive quaternion parametrization" />
  </class>

  <!-- old data -->

  <!-- new data -->

  <enum name="Reconstruction Functor Optimization Error Type">
    <item name="REPROJECTION"  id="0" />
    <item name="ANGULAR"       id="1" />
    <item name="CROSS_PRODUCT" id="2" />
    <item name="RAY_DIFF"      id="3" />
  </enum>
  
  <class name="Iterative Reconstruction Nonlinear Optimization Params">
    <!-- // By default only orientations and reconstructed points are subject for optimization -->
    <!-- <filed type="ReconstructionFunctorOptimizationType" name="optimizationParams" defaultValue= -->
    <!--     ReconstructionFunctorOptimizationType::NON_DEGENERATE_ORIENTATIONS | ReconstructionFunctorOptimizationType::DEGENERATE_ORIENTATIONS | ReconstructionFunctorOptimizationType::FOCALS | ReconstructionFunctorOptimizationType::PRINCIPALS | -->
    <!--     ReconstructionFunctorOptimizationType::POINTS; -->
        
    <field type="Reconstruction Functor Optimization Error Type" name="errorType" defaultValue="3" comment="Functor optimizattion error type" />
    <field type="int" name="postAppendNonlinearIterations" defaultValue="200" comment="Post-append non-linear optimization iterations" />
    <field type="int" name="finalNonLinearIterations" defaultValue="2000" comment="Final non-linear iterations" />
    <field type="int" name="alternatingIterations" defaultValue="20" comment="Alternating optimization on success steps" />

    <field type="bool" name="excessiveQuaternionParametrization" defaultValue="true" comment="Excessive/non-excessive quaternion parametrization" />
  </class>

  <!-- new data -->

</poco>

